' Diagram showing sequence of tasks to set up PMM Client for MySQL
' Syntax: https://plantuml.com/activity-diagram-beta
' Icons: https://plantuml.com/openiconic
' Colour: https://plantuml.com/color
' Text: https://plantuml.com/creole
@startuml "setting-up_client_mysql"
skinparam ArrowHeadColor none
skinparam roundCorner 10
skinparam legendBackgroundColor #0000
'title "Setting up PMM Client to monitor a MySQL host\nOverview\n"
legend bottom left
Legend
<#lemonchiffon>| Required |
<#lightgrey>| Optional |
endlegend

partition "1. Choose and configure a source" {
	if (Choose a source) then (**//slow query log//**)
		:1.1. **//slow query log//**;
		:1.2. slow query log -- additional**;
		#lightgrey:1.3. slow query log rotation**;
		#lightgrey:1.3. **//query response time//**;
		#lightgrey:1.4. **//tablestats//**;
	else (**//Performance Schema//**)
		:1.5. **//Performance Schema//**;
		:1.6. **//Query Analytics//**;
	endif
	#lightgrey:1.7. **//user statistics//**;
	#lightgrey:1.8. PMM database account;
}
partition "2. Add service" {
	if () then (**2.1. User interface**)
		:PMM <&arrow-thick-right> PMM Add Instance <&arrow-thick-right>\nMySQL - Add a remote instance;
		kill
	else (**2.2. Command line**)
		if () then (**Slow query log**)
			:<code>
			pmm-admin add mysql
			--query-source=slowlog
			--size-slow-logs=N
			...
			</code>;
		else (**Performance Schema**)
			:<code>
			pmm-admin add mysql
			--query-source=perfschema
			...
			</code>;
		endif
		kill
	endif
}
#lightgrey:3. Check;
@enduml
